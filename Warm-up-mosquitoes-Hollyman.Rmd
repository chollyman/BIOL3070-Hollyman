---
title: "Warm-up mini-Report: Mosquito Blood Hosts in \n Salt Lake City, Utah"
author: "Corinne Hollyman"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# ABSTRACT

This report investigates the species that mosquitoes in the Salt Lake City area are taking blood meals from, and the prevalence of mosquitoes infected with West Nile Virus. Through COI sequencing, the species each mosquito took a blood meal from was identified, as well as if each sample was infected with West Nile Virus. This data was then analyzed to examine the correlation between House Finch blood meals and viral infections. House Finches were found to have a positive correlation with West Nile Virus prevalence, indicating that House Finches are acting as amplifying hosts of WNV in Salt Lake City, UT. 

# BACKGROUND

West Nile Virus is a virus that affects both humans and other animal hosts, with the predominant reservoir being various bird species. The cycle of transmission is facilitated by mosquitoes, as they take blood meals from infected birds and transmit the disease to other mammals, often humans. Human-to-human transmission is not often seen, although it can be spread through blood transfusion or organ transplantation (*About West Nile*, 2025). Humans and other mammals are considered "dead-end" hosts, as the levels of viremia are often not enough to transmit the disease back to mosquitoes (Colpitts et al., 2012). As of October 7, 2025, there have been 1,433 human cases of West Nile Virus reported across the US, with 43 cases reported in the state of Utah (*Current Year Data (2025)*, 2025). 

The below barplot, with data sourced from a paper published on experimental infection of North American birds with West Nile virus (Komar et al., 2003), illustrates the varied duration of time in which WNV is detectable in a variety of bird species after infection. Species with a longer viremic period have greater opportunities for transmission to mosquitoes, and therefore are more effective amplifying hosts. House Finches, with their long viremia span and commonality are posed to be highly influential to the spread of West Nile Virus in Salt Lake City. 

```{r viremia, include=TRUE, eval=TRUE, warning=FALSE, fig.align='left', fig.width=4.75, fig.height=7}
# Manually transcribe duration (mean, lo, hi) from the last table column
duration <- data.frame(
  Bird = c("Canada Goose","Mallard", 
           "American Kestrel","Northern Bobwhite",
           "Japanese Quail","Ring-necked Pheasant",
           "American Coot","Killdeer",
           "Ring-billed Gull","Mourning Dove",
           "Rock Dove","Monk Parakeet",
           "Budgerigar","Great Horned Owl",
           "Northern Flicker","Blue Jay",
           "Black-billed Magpie","American Crow",
           "Fish Crow","American Robin",
           "European Starling","Red-winged Blackbird",
           "Common Grackle","House Finch","House Sparrow"),
  mean = c(4.0,4.0,4.5,4.0,1.3,3.7,4.0,4.5,5.5,3.7,3.2,2.7,1.7,6.0,4.0,
           4.0,5.0,3.8,5.0,4.5,3.2,3.0,3.3,6.0,4.5),
  lo   = c(3,4,4,3,0,3,4,4,4,3,3,1,0,6,3,
           3,5,3,4,4,3,3,3,5,2),
  hi   = c(5,4,5,5,4,4,4,5,7,4,4,4,4,6,5,
           5,5,5,7,5,4,3,4,7,6)
)

# Choose some colors
cols <- c(rainbow(30)[c(10:29,1:5)])  # rainbow colors

# horizontal barplot
par(mar=c(5,12,2,2))  # wider left margin for names
bp <- barplot(duration$mean, horiz=TRUE, names.arg=duration$Bird,
              las=1, col=cols, xlab="Days of detectable viremia", xlim=c(0,7))

# add error bars
arrows(duration$lo, bp, duration$hi, bp,
       angle=90, code=3, length=0.05, col="black", xpd=TRUE)
```

# STUDY QUESTION and HYPOTHESIS

## Questions  


Which bird species have the highest potential for transmission of West Nile Virus by acting as amplifying hosts in Salt Lake City?

## Hypothesis 

House Finches carry a higher potential for transmission of West Nile Virus to humans via mosquitoes than other local species. 

## Prediction
If House Finches are acting as amplifying hosts for West Nile Virus, then areas with more House Finch blood meals will have higher levels of WNV in the pool of mosquitoes.

# METHODS

Over 300 mosquitoes were collected at various locations in Salt Lake City, UT. Polymerase Chain Reaction (PCR) was performed to amplify the amount of mitochondrial DNA present in the blood meals taken by the mosquitoes. After verifying the success of the PCR process with gel electrophoresis, the mitochondrial DNA was sequenced using MinION sequencing. The COI sequence for each blood meal was then analyzed using BLASTn at NCBI to identify the species each blood meal was taken from. Each sample was also analyzed to determine if West Nile Virus was present. The first analysis of the data was a horizontal barplot visualization, looking at the number of blood meals taken per species, both in locations that were positive for WNV and locations that were not. The second analysis performed was a generalized linear model of the relationship between the number of blood meals taken from House Finches and the number of mosquitoes infected with WNV per location sampled.

## First Analysis- Horizontal Barplots
Horizontal plots:
```{r horiz-plot,fig.align='left',fig.width=7,fig.height=7, warning=FALSE}
## import counts_matrix: data.frame with column 'loc_positives' (0/1) and host columns 'host_*'
counts_matrix <- read.csv("./bloodmeal_plusWNV_for_BIOL3070.csv")

## 1) Identify host columns
host_cols <- grep("^host_", names(counts_matrix), value = TRUE)

if (length(host_cols) == 0) {
  stop("No columns matching '^host_' were found in counts_matrix.")
}

## 2) Ensure loc_positives is present and has both levels 0 and 1 where possible
counts_matrix$loc_positives <- factor(counts_matrix$loc_positives, levels = c(0, 1))

## 3) Aggregate host counts by loc_positives
agg <- stats::aggregate(
  counts_matrix[, host_cols, drop = FALSE],
  by = list(loc_positives = counts_matrix$loc_positives),
  FUN = function(x) sum(as.numeric(x), na.rm = TRUE)
)

## make sure both rows exist; if one is missing, add a zero row
need_levels <- setdiff(levels(counts_matrix$loc_positives), as.character(agg$loc_positives))
if (length(need_levels)) {
  zero_row <- as.list(rep(0, length(host_cols)))
  names(zero_row) <- host_cols
  for (lv in need_levels) {
    agg <- rbind(agg, c(lv, zero_row))
  }
  ## restore proper type
  agg$loc_positives <- factor(agg$loc_positives, levels = c("0","1"))
  ## coerce numeric host cols (they may have become character after rbind)
  for (hc in host_cols) agg[[hc]] <- as.numeric(agg[[hc]])
  agg <- agg[order(agg$loc_positives), , drop = FALSE]
}

## 4) Decide species order (overall abundance, descending)
overall <- colSums(agg[, host_cols, drop = FALSE], na.rm = TRUE)
host_order <- names(sort(overall, decreasing = TRUE))
species_labels <- rev(sub("^host_", "", host_order))  # nicer labels

## 5) Build count vectors for each panel in the SAME order
counts0 <- rev(as.numeric(agg[agg$loc_positives == 0, host_order, drop = TRUE]))
counts1 <- rev(as.numeric(agg[agg$loc_positives == 1, host_order, drop = TRUE]))

## 6) Colors: reuse your existing 'cols' if it exists and is long enough; otherwise generate
if (exists("cols") && length(cols) >= length(host_order)) {
  species_colors <- setNames(cols[seq_along(host_order)], species_labels)
} else {
  species_colors <- setNames(rainbow(length(host_order) + 10)[seq_along(host_order)], species_labels)
}

## 7) Shared x-limit for comparability
xmax <- max(c(counts0, counts1), na.rm = TRUE)
xmax <- if (is.finite(xmax)) xmax else 1
xlim_use <- c(0, xmax * 1.08)

## 8) Plot: two horizontal barplots with identical order and colors
op <- par(mfrow = c(1, 2),
          mar = c(4, 12, 3, 2),  # big left margin for species names
          xaxs = "i")           # a bit tighter axis padding

## Panel A: No WNV detected (loc_positives = 0)
barplot(height = counts0,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "Locations WNV (-)",
        xlim = xlim_use)

## Panel B: WNV detected (loc_positives = 1)
barplot(height = counts1,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "Locations WNV (+)",
        xlim = xlim_use)

par(op)

## Keep the colors mapping for reuse elsewhere
host_species_colors <- species_colors
```



## Second Analysis- Generalized Linear Model
```{r}
#glm with house-finch alone against positivity rate
glm2 <- glm(loc_rate ~ host_House_finch,
            data = counts_matrix)
summary(glm2)
```



# DISCUSSION

## Interpretation of Horizontal Barplots
The bar plot on the left demonstrates the distribution of species that blood meals were taken at locations that were negative for West Nile Virus. The bar plot on the right looks at the distribution of species at locations that were positive for West Nile Virus. In both plots, the top three species were House Finches, House Sparrows, and American Robins. However, at locations that were positive for West Nile Virus, the number of blood meals taken from House Finches was much higher, demonstrating a positive correlation between blood meals from House Finches and prevalence of West Nile Virus. 

## Interpretation of Generalized Linear Model
The generalized linear model looks at the relationship between the number of blood meals taken from House Finches and the number of mosquitoes infected with West Nile Virus per location. The estimate of this relationship is 0.0275, meaning that there is a slight positive correlation between the number of blood meals from House Finches and the number of infected mosquitoes. While this correlation doesn't appear strong, it is statistically significant, as it has a p-value of 4.54e-05, meaning that it is extremely unlikely that this correlation is due simply to chance. 

# CONCLUSION
Analysis of the data collected has demonstrated that while many mosquitoes take blood meals from many species in Salt Lake City, there is a positive correlation between blood meals taken from House Finches and mosquitoes infected with West Nile Virus. This correlation implies that House Finches are acting as important amplifying hosts for WNV in Salt Lake City. Future efforts to limit the prevalence of West Nile Virus in the mosquito population may consider this correlation when selecting areas of focus.

# REFERENCES     

1. About West Nile. (2025, September 10). West Nile Virus. https://www.cdc.gov/west-nile-virus/about/index.html

2. Colpitts, T. M., Conway, M. J., Montgomery, R. R., & Fikrig, E. (2012). West Nile Virus: biology, transmission, and human infection. Clinical Microbiology Reviews, 25(4), 635â€“648. https://doi.org/10.1128/cmr.00045-12

3. Current year data (2025). (2025, October 7). West Nile Virus. https://www.cdc.gov/west-nile-virus/data-maps/current-year-data.html

4. Komar N, Langevin S, Hinten S, Nemeth N, Edwards E, Hettler D, Davis B, Bowen R, Bunning M. Experimental infection of North American birds with the New York 1999 strain of West Nile virus. Emerg Infect Dis. 2003 Mar;9(3):311-22. https://doi.org/10.3201/eid0903.020628

5. ChatGPT. OpenAI, version Jan 2025. Used as a reference for functions such as plot() and to correct syntax errors. Accessed `r Sys.Date()`.



